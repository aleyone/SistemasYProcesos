package es.syp4.ae4;

import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.net.ServerSocket;
import java.net.Socket;

public class Server {

	public static void main(String[] args) {
		int puerto = 1234;
		try {
			ServerSocket servidor = new ServerSocket(puerto);
			System.err.println("SERVIDOR >>> Waiting for connection....");
			Socket clientConnection = servidor.accept();
			Thread.sleep(3000);
			ObjectOutputStream outObject = new ObjectOutputStream(clientConnection.getOutputStream());
			Password pass = new Password("Texto Plano");
			outObject.writeObject(pass);
			System.err.println("SERVIDOR >>> Sending empty object: "+pass.getTextPass());
			ObjectInputStream inObject = new ObjectInputStream(clientConnection.getInputStream());
			Password modPass = (Password) inObject.readObject();
			Thread.sleep(3000);
			System.err.println("SERVIDOR >>> Receiving data from user: "+modPass.getTextPass());
			modPass.MD5Enc("myKey", modPass.getTextPass());
			outObject = new ObjectOutputStream(clientConnection.getOutputStream());
			outObject.writeObject(modPass);
			System.err.println("SERVIDOR >>> Sending complete object... > "+modPass.getTextPass()+" - "+modPass.getEncryptedPass());
			outObject.close();
			inObject.close();
			clientConnection.close();
			servidor.close();
			
			
		} catch (InterruptedException e) {
		} catch (ClassNotFoundException e) {
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		
	}

}
